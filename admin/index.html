<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin | Portafolio</title>
  <style>
    :root{
      --bg:#0b1220; --panel:#0f1a2b; --text:#eaf0ff; --muted:#9fb0d0; --border:#1b2a44;
      --accent:#4f8cff; --good:#22c55e; --shadow:0 18px 50px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(79,140,255,.18), transparent 60%),
        radial-gradient(900px 500px at 85% 30%, rgba(34,197,94,.12), transparent 60%),
        var(--bg);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    .top{
      display:flex;justify-content:space-between;align-items:center;gap:12px;
      padding:14px 16px;border:1px solid rgba(27,42,68,.75);
      background:rgba(15,26,43,.6);border-radius:18px;box-shadow:var(--shadow);
      position:sticky;top:16px;backdrop-filter:blur(10px)
    }
    .brand{display:flex;align-items:center;gap:10px;font-weight:900}
    .dot{width:10px;height:10px;border-radius:999px;background:var(--accent);box-shadow:0 0 0 6px rgba(79,140,255,.15)}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:10px 12px;border-radius:12px;text-decoration:none;font-weight:800;
      border:1px solid rgba(27,42,68,.75); background:rgba(15,26,43,.6); color:var(--text);
    }
    .btn:hover{border-color:rgba(79,140,255,.55)}
    .btn.good{background:var(--good);color:#06110a;border-color:transparent}
    h1{margin:22px 0 6px;font-size:2rem;line-height:1.1}
    p{margin:0;color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:16px}
    .card{
      border:1px solid rgba(27,42,68,.75); background:rgba(15,26,43,.6);
      border-radius:18px;padding:14px; box-shadow:0 12px 30px rgba(0,0,0,.18)
    }
    .card h3{margin:0 0 6px}
    .card small{color:var(--muted)}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .preview{margin-top:20px}
    .items{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;margin-top:10px}
    .item{
      display:block;text-decoration:none;color:var(--text);
      border:1px solid rgba(27,42,68,.75); background:rgba(15,26,43,.6);
      border-radius:18px;overflow:hidden;
      transition:transform .12s ease,border-color .12s ease;
    }
    .item:hover{transform:translateY(-2px);border-color:rgba(79,140,255,.55)}
    .img{width:100%;height:160px;background:rgba(11,21,38,.85);display:flex;align-items:center;justify-content:center;color:var(--muted)}
    .img img{width:100%;height:100%;object-fit:cover;display:block}
    .body{padding:12px}
    .meta{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .pill{font-size:.78rem;padding:6px 10px;border-radius:999px;border:1px solid rgba(27,42,68,.75);color:var(--muted)}
    @media (max-width: 900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand"><span class="dot"></span> Admin · Portafolio</div>
      <div class="actions">
        <a class="btn" href="/" target="_blank" rel="noopener">Ver sitio</a>
        <a class="btn" href="https://github.com/AngelSantos36/Repositorio" target="_blank" rel="noopener">Repo</a>
      </div>
    </div>

    <h1>Panel Admin</h1>
    <p>Sube trabajos sin pelearte con logins raros. Esto actualiza el sitio cuando haces commit en GitHub.</p>

    <div class="grid">
      <div class="card">
        <h3>1) Subir imágenes</h3>
        <small>Sube portadas a <b>assets/uploads</b>.</small>
        <div class="actions">
          <a class="btn good" href="https://github.com/AngelSantos36/Repositorio/upload/main/assets/uploads" target="_blank" rel="noopener">Subir imágenes</a>
        </div>
      </div>

      <div class="card">
        <h3>2) Editar portafolio</h3>
        <small>Edita <b>content/portfolio.json</b> (títulos, links, descripción).</small>
        <div class="actions">
          <a class="btn good" href="https://github.com/AngelSantos36/Repositorio/edit/main/content/portfolio.json" target="_blank" rel="noopener">Editar JSON</a>
        </div>
      </div>

      <div class="card">
        <h3>3) Revisión rápida</h3>
        <small>Vista previa de los items publicados (se lee del JSON).</small>
        <div class="actions">
          <button class="btn" id="reload">Recargar preview</button>
        </div>
      </div>
    </div>

    <div class="preview">
      <h2 style="margin:18px 0 6px">Vista previa</h2>
      <p>Si aquí aparece, el home también lo carga.</p>
      <div class="items" id="items"></div>
      <p id="err" style="margin-top:10px;color:#ffcc66"></p>
    </div>
  </div>

  <script>
    async function load(){
      const itemsEl = document.getElementById('items');
      const err = document.getElementById('err');
      err.textContent = '';
      itemsEl.innerHTML = '';

      try{
        const res = await fetch('/content/portfolio.json', { cache:'no-store' });
        const data = await res.json();
        const items = data.items || [];

        if(!items.length){
          itemsEl.innerHTML = '<div class="card">Aún no hay trabajos. Edita el JSON y agrega items.</div>';
          return;
        }

        itemsEl.innerHTML = items.map(it => `
          <a class="item" href="${it.link || '#'}" target="_blank" rel="noopener">
            <div class="img">
              ${it.cover ? `<img src="${it.cover}" alt="">` : 'Sin portada'}
            </div>
            <div class="body">
              <div style="font-weight:900">${it.title || 'Trabajo'}</div>
              <div style="color:#9fb0d0;font-size:.92rem;margin-top:4px">${it.desc || ''}</div>
              <div class="meta">
                <span class="pill">${it.type || 'video'}</span>
                ${it.category ? `<span class="pill">${it.category}</span>` : ''}
              </div>
            </div>
          </a>
        `).join('');
      }catch(e){
        err.textContent = 'No pude leer /content/portfolio.json. Revisa que exista y sea JSON válido.';
      }
    }
    document.getElementById('reload').addEventListener('click', load);
    load();
      if (sessionStorage.getItem('admin_ok') !== '1') {
        location.href = "/admin/login.html";
        }
  </script>
</body>
</html>

